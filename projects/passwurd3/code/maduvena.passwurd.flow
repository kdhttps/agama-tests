Flow maduvena.passwurd
     Basepath ""
     Timeout 1000 seconds
     Configs config
     Inputs credentialMap otpPassed userExists validateKeystrokesResult 
initializeCredentialMap | exception = Call io.jans.passwurd.UserCheck#initCredentialMap credentialMap
result | exception = Call io.jans.passwurd.UserCheck#initializeFlow config
credential = RRF "username.ftlh" 
credentialMap.username = "credential.username"
credential = RRF "UsernamePasswurd.ftlh" credential
credential.k_username = "credentialMap.k_username"
credential.k_pwd = "credentialMap.k_pwd"
resultValidation | exception = Call io.jans.passwurd.UserCheck#validateKeystrokes credentialMap
Log "@info resultValidation ----- " resultValidation
When resultValidation is not -2
     Log "@info Proceed, not incorrect password"
     When resultValidation is not -4
          Log "@info Proceed. No server error"
          When resultValidation is not 0
               credentialMap = RRF "otp.ftlh" credentialMap
               Log "@info credentialMap" 
               otpResult | exception = Call io.jans.passwurd.UserCheck#validateOTP credentialMap
               resultValidation = "credentialMap.trackId"
               When otpResult is true
                    resultNotify | exception = Call io.jans.passwurd.UserCheck#notifyProfile credentialMap
                    Finish credentialMap.username
               Finish false
          Finish credentialMap.username
     Finish false
Finish false