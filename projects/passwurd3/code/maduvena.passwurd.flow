Flow maduvena.passwurd
     Basepath ""
     Timeout 1000 seconds
     Configs config
     Inputs credentialMap otpPassed userExists validateKeystrokesResult 
initializeCredentialMap | exception = Call io.jans.passwurd.UserCheck#initCredentialMap credentialMap
result | exception = Call io.jans.passwurd.UserCheck#initializeFlow config
credentialMap = RRF "username.ftlh" 
resultUserExists | exception = Call io.jans.passwurd.UserCheck#userExists credentialMap
Log "@info User Exists: " resultUserExists
credentialMap = RRF "UsernamePasswurd.ftlh" 
validKeystrokes = "false"
serverError = "false"
incorrectPassword = "false"
trackId = "false"
resultValidation | exception = Call io.jans.passwurd.UserCheck#validateKeystrokes credentialMap
Log "@info resultValidation ----- " resultValidation
When resultValidation is not -2
     Log "@info Proceed, not incorrect password"
     When resultValidation is not -4
          Log "@info Proceed. No server error"
          When resultValidation is not 0
               credentialMap = RRF "otp.ftlh" credentialMap
               otpResult | exception = Call io.jans.passwurd.UserCheck#validateOTP credentialMap
               resultValidation = "credentialMap.trackId"
               When otpResult is true
                    resultNotify | exception = Call io.jans.passwurd.UserCheck#notifyProfile credentialMap
                    Finish credentialMap.username
               Finish false
          Finish credentialMap.username
     Finish false
Finish false