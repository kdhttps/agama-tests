Flow maduvena.io.jans.agama.passwurd
     Basepath ""
     Timeout 1000 seconds
     Configs config
     Inputs credentialMap
credentialMap | exception = Call io.jans.passwurd.UserCheck#initCredentialMap credentialMap
result | exception = Call io.jans.passwurd.UserCheck#initializeFlow config
Log "@info " config
Log "@error " exception
credentialMap = RRF "username.ftlh" 
result | exception = Call io.jans.passwurd.UserCheck#userExists credentialMap
When result is not true
     Repeat 5 times max
          result = RRF "UsernamePasswurd.ftlh" credentialMap
          result | exception = Call io.jans.passwurd.UserCheck#validateKeystrokes credentialMap
          Finish true
result = RRF "UsernamePasswurd.ftlh" creds
result | exception = Call io.jans.passwurd.UserCheck#validateUser creds
When result is true
     Finish result
result | exception = Trigger TwoFA credentialMap