Flow maduvena.passwurd
     Basepath ""
credentialMap | exception = Call io.jans.passwurd.UserCheck#initCredentialMap credentialMap
result | exception = Call io.jans.passwurd.UserCheck#initializeFlow config
Log "@info " config
Log "@error " exception
credentialMap = RRF "username.ftlh" 
Log "@info " credentialMap
resultCheck | exception = Call io.jans.passwurd.UserCheck#userExists credentialMap
When resultCheck is not true
     Repeat 5 times max
          credentialMap = RRF "UsernamePasswurd.ftlh" 
          resultValidation | exception = Call io.jans.passwurd.UserCheck#validateKeystrokes credentialMap
          Log "@error Exceptions Validate keystrokes" exceptions
          Finish true
credentialMap = RRF "UsernamePasswurd.ftlh" 
Log "@info Credentials captured: " credentialMap
resultCode | exception = Call io.jans.passwurd.UserCheck#validateKeystrokes credentialMap
Log "@error Exceptions from validate Keystrokes" exception
Log "@info Validate Keystrokes resultCode" resultCode
When resultCode is -1
     Log "@info " Authentication successful
     Finish true
When resultCode is -2
     Log "@error " Password Incorrect
     Finish false
When resultCode is -3
     Log "@error " Some server error
     Finish false
Log "@info Track id is : " resultCode
credentialMap = RRF "otp.ftlh" credentialMap
otpResult | exception = Call io.jans.passwurd.UserCheck#validateOTP credentialMap
When otpResult is true
     Log "@info " OTP authenticated successfully
     resultNotify | exception = Call io.jans.passwurd.UserCheck#notifyProfile credentialMap
     Log "@info Result of Notify Profile : " resultNotify 
     Log "@info Authentication completed"
     Finish true
Log "@error " OTP authentication failed
Finish false