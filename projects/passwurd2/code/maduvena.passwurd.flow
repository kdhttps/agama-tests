Flow maduvena.passwurd
     Basepath ""
     Timeout 1000 seconds
     Configs config
     Inputs credentialMap
credentialMap | exception = Call io.jans.passwurd.UserCheck#initCredentialMap credentialMap
result | exception = Call io.jans.passwurd.UserCheck#initializeFlow config
Log "@info " config
Log "@error " exception
credentialMap = RRF "username.ftlh" 
Log "@info " credentialMap
resultCheck | exception = Call io.jans.passwurd.UserCheck#userExists credentialMap
Log "@error " exception
When resultCheck is not null
     Log "@info " Condition met User enrollment
     Repeat 5 times max
          credentialMap = RRF "UsernamePasswurd.ftlh" 
          resultValidation | exception = Call io.jans.passwurd.UserCheck#validateKeystrokes credentialMap
          Log "@error " exception
     Log "@info " Completed 5 iterations of recording keystrokes
     resultUser | exception = Call  io.jans.passwurd.UserCheck#addUser credentialMap
     Finish true
credentialMap = RRF "UsernamePasswurd.ftlh" 
Log "@info " credentialMap
resultCode | exception = Call io.jans.passwurd.UserCheck#validateKeystrokes credentialMap
Log "@error " exception
Log "@info " resultCode
When resultCode is -1
     Log "@info " Authentication successful
When resultCode is -2
     Log "@info " temp nothing log
When resultCode is -3
     Log "@info " random log
Log "@info " resultCode
credentialMap = RRF "otp.ftlh" credentialMap
otpResult | exception = Call io.jans.passwurd.UserCheck#validateOTP credentialMap
When otpResult is true
     Log "@info " Temp logging
Log "@error " OTP authentication failed
Finish false